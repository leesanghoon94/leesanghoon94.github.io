## Kibana 알림 액션 실습 예제

### Kibana 알림 액션 개요

Kibana의 알림 액션은 특정 조건이 발생했을 때, 이메일, Slack, 또는 다른 통합된 서비스로 알림을 보내는 기능입니다. 예를 들어, 서버의 CPU 사용량이 임계값을 초과하거나, 특정 로그 메시지가 나타나면 담당자에게 알림을 보내 문제를 빠르게 파악하고 해결할 수 있도록 도와줍니다.

### 알림 액션 설정 단계

1. **알림 정책 생성:**

   - **Kibana 메뉴:** 네비게이션 메뉴에서 **Stack Management** > **Alerting** > **Policies**로 이동합니다.
   - **새 정책 생성:** '+' 버튼을 클릭하여 새로운 알림 정책을 생성합니다.
   - **조건 설정:** 알림을 발생시킬 조건을 설정합니다. 예를 들어, 특정 메트릭의 값이 임계값을 초과하거나, 특정 로그 메시지가 나타나는 경우 등을 설정할 수 있습니다.
   - **알림 액션 설정:** 알림이 발생했을 때 실행될 액션을 설정합니다. 이메일, Slack, 또는 다른 통합된 서비스를 선택하고, 알림 메시지의 내용을 작성합니다.

2. **알림 테스트:**
   - 생성한 알림 정책을 테스트하여 정상적으로 작동하는지 확인합니다.
   - 테스트를 통해 알림 메시지가 예상대로 전달되는지 확인하고, 필요한 경우 설정을 수정합니다.

### 실제 예제: Slack으로 알림 보내기

**조건:** CPU 사용량이 80%를 초과하면 Slack으로 알림

1. **알림 정책 생성:**

   - **조건:**
     - 메트릭: system.cpu.load_average.1m
     - 연산자: greater_than
     - 값: 80
   - **알림 액션:**
     - **유형:** Slack
     - **채널:** #kibana_alerts
     - **메시지:** "CPU 사용량이 80%를 초과했습니다. 즉시 확인해주세요."

2. **Slack 설정:**
   - Kibana에서 Slack 앱을 추가하고, 필요한 인증 정보를 입력합니다.

### 알림 액션 예시 (JSON 형식)

```json
{
  "policy_id": "my_cpu_alert",
  "description": "Alert when CPU usage is over 80%",
  "enabled": true,
  "trigger": {
    "schedule": {
      "interval": "1m"
    }
  },
  "actions": [
    {
      "id": "slack-notification",
      "params": {
        "channel": "#kibana_alerts",
        "message": "CPU usage is over 80%. Please check immediately."
      }
    }
  ],
  "condition": {
    "script": {
      "source": """
        params._source.system.cpu.load_average.1m > 80
      """
    }
  }
}
```

### 추가 팁

- **다양한 알림 액션:** 이메일, Slack 외에도 다양한 알림 액션을 사용할 수 있습니다.
- **복잡한 조건:** Elasticsearch Query DSL을 사용하여 복잡한 조건을 설정할 수 있습니다.
- **알림 스케줄:** 알림을 주기적으로 실행하거나, 특정 시간대에만 실행하도록 설정할 수 있습니다.
- **알림 그룹:** 여러 알림 정책을 하나의 그룹으로 묶어 관리할 수 있습니다.

### 주의사항

- **Kibana 버전:** 사용하는 Kibana 버전에 따라 설정 방법이 다를 수 있습니다.
- **Elasticsearch 설정:** Elasticsearch 설정에 따라 알림 기능이 제한될 수 있습니다.
- **X-Pack:** X-Pack 라이선스가 필요한 경우가 있습니다.

**더 자세한 정보는 Kibana 공식 문서를 참고하세요.**

**궁금한 점이 있다면 언제든지 질문해주세요.**

**주의:** 위 예제는 간단한 예시이며, 실제 환경에서는 더 복잡한 설정이 필요할 수 있습니다.

**다음에 궁금한 점이 있다면 무엇이든 물어보세요.**

- Kibana 알림 설정에 대한 더 자세한 설명이 필요하신가요?
- 특정 알림 액션에 대한 예시를 원하시나요?
- Elasticsearch 쿼리에 대한 도움이 필요하신가요?

**어떤 질문이든 환영합니다!**
